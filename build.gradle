ext {
  buildNumber = System.getenv('BUILD_NUMBER')
}

task build_number << {
  println buildNumber
}

task composer(type:Exec) {
  workingDir './laravel'
  commandLine 'composer', 'update'
}

task phpunit(type:Exec) {
  workingDir './laravel'
  commandLine 'phpunit'
  args '--coverage-html', '../build/coverage'
}

task phpdpkg(type:Exec) {
  workingDir '.'
  commandLine 'phpdpkg'
}

task deploy(dependsOn:[build_number, composer, phpunit, phpdpkg]) {
}
